(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{679:function(e,t,n){},772:function(e,t,n){"use strict";n(679)},775:function(e,t,n){"use strict";n.r(t);var s=n(118),r=(n(201),n(91),n(92),n(50),n(339),n(40),n(204),n(121),n(69),n(25),n(24)),o=n.n(r),a=n(282),i=o.a.create();i.defaults.baseURL="https://gitlab.cae.com/api/v4",i.defaults.headers.common["PRIVATE-TOKEN"]="es_U4rCHsSfQfoHGezTK",i.defaults.timeout=2500,i.interceptors.request.use((function(e){return e}),(function(e){return Object(a.Message)({showClose:!0,message:"请求失败",type:"error"}),Promise.reject(e)})),i.interceptors.response.use((function(e){var t={};return t.data=e.data,t.totalPage=e.headers["x-total-pages"],e.data=t,e}),(function(e){if(405!==e.response.status)return Promise.reject(e);window.location.href="/"}));var c={membersOfProject:"/projects/:id/members",issuesOfProject:"/projects/:id/issues",labelsOfProject:"/projects/:id/labels",issueDisOfProject:"/projects/:projId/issues/:issueId/notes"};function u(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return i.get(c.issueDisOfProject.replace(":projId",e).replace(":issueId",t),{params:n}).then((function(e){return Promise.resolve(e.data)}))}n(644),n(647),n(88),n(342),n(765);var l=n(766),d=n.n(l),p=n(767),f=n.n(p);function h(e){return e.startsWith("\n")&&(e=e.substring(1)),e.endsWith("\n")&&(e=e.substring(0,line.length-2)),e}var m=n(770),v=(n(771),{name:"md-to-excel",data:function(){return{projId:"",issueId:"",mdContent:"",mdHtml:"",exportBtn:{text:"导出为Excel",loading:!1}}},components:{mavonEditor:m.mavonEditor},methods:{_getMdTable:function(e){var t=/\|[\s\S]*\|[\s-]+\|[\s\S]*\||<table>[\s\S]*<\/table>/,n=/<tr>[\s\S]*?<\/tr>/m,s="",r="";e.forEach((function(e){var o=e.body,a=t.exec(o),i="";if(a){i=a[0],n.exec(i)&&(i=function(e){for(var t,n=/(<tr>[\s\S]*?<\/tr>)/g,s=/(<t[dh]>[\s\S]*?<\/t[dh]>)/g,r=/<t[dh]>([\s\S]*?)<\/t[dh]>/,o=[],a="",i="| ";t=n.exec(e);)o.push(t[1]);return o.forEach((function(e,n){for(var o=[];t=s.exec(e);)o.push(t[1]);a+="| ";var c="";0==n?(o.forEach((function(e){c=r.exec(e)[1],a+=c+" | ",i+="---- | "})),a+="\n"+i+"\n"):(o.forEach((function(e){c=r.exec(e)[1],a+=c+" | "})),a+="\n")})),a}(i));var c=i.split("\n");s=""!=s?s:c[0]+"\n"+c[1]+"\n",c[2]&&(c=c.slice(2),r+=c.join("\n")+"\n")}})),r=s+r,this.mdContent=r},_getProjIssueDiscuss:function(){var e=this;return Object(s.a)(regeneratorRuntime.mark((function t(){var n,s,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=[],s=2,r=1;case 1:if(!(r<=s)){t.next=6;break}return t.next=4,u(e.projId,e.issueId,{per_page:100,page:r}).then((function(e){s=e.totalPage,n=n.concat(e.data),++r}));case 4:t.next=1;break;case 6:e._getMdTable(n);case 7:case"end":return t.stop()}}),t)})))()},confirm:function(){this._getProjIssueDiscuss()},change:function(e,t){this.mdHtml=t},exportAsExl:function(){var e=this;""!=this.mdContent&&(this.exportBtn.loading=!0,this.exportBtn.text="导出中",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"workbook",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sheet",s=(e=h(e.trim())).split("\n");if(0!==s.length){s.splice(1,1);var r=new d.a.Workbook;r.creator="xtwan",r.lastModifiedBy="xtwan",r.created=new Date,r.modified=new Date,r.lastPrinted=new Date,r.properties.date1904=!0;var o=r.addWorksheet(n),a=s.splice(0,1)[0].trim().split("|"),i=[];a.forEach((function(e,t){""!=e&&i.push({header:e.trim(),key:t,width:20})})),o.columns=i,s.forEach((function(e){var t=(e=(e=e.substring(1)).substring(0,e.length-2)).trim().split("|");o.addRow(t)}));var c=t+".xlsx";return r.xlsx.writeBuffer().then((function(e){return f.a.saveAs(new Blob([e]),c),Promise.resolve(!0)}))}}(this.mdContent).then((function(){e.exportBtn.text="导出为Excel",e.exportBtn.loading=!1})))}}}),x=(n(772),n(4)),g=Object(x.a)(v,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("div",{staticClass:"u-header"},[n("label",[e._v("项目ID&Issue ID：")]),e._v(" "),n("el-input",{staticClass:"u-proj-id-input",attrs:{placeholder:"项目id"},model:{value:e.projId,callback:function(t){e.projId=t},expression:"projId"}}),e._v(" "),n("el-input",{staticClass:"u-proj-issue-id-input",attrs:{placeholder:"Issue id"},model:{value:e.issueId,callback:function(t){e.issueId=t},expression:"issueId"}}),e._v(" "),n("el-button",{staticClass:"u-conirm-btn",attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确定")])],1),e._v(" "),n("div",{staticClass:"u-content"},[n("mavon-editor",{ref:"md",staticClass:"u-markdown-editer",on:{change:e.change},model:{value:e.mdContent,callback:function(t){e.mdContent=t},expression:"mdContent"}}),e._v(" "),n("el-button",{staticClass:"u-editor-btn",attrs:{type:"primary",loading:e.exportBtn.loading},on:{click:e.exportAsExl}},[e._v("\n      "+e._s(e.exportBtn.text)+"\n    ")])],1)])}),[],!1,null,"0bcf079e",null);t.default=g.exports}}]);